# 2. Cellデータ構造

## 2.1 定義
アプリケーションのデータの基本単位を「Cell（セル）」と呼びます。
データベースのレコードはCellを単位に記録し、Cellのデータメンバがカラムになります。

## 2.2 Cellの思想
Cellの役割は記録の保存であり、シンプルながら多彩な振る舞いができる構造を重視している。

## 2.3 メンバ定義
Cellはクラスにより管理され、以下のデータメンバを持っています。シンプルさから情報の多くは文字列で管理されます。

| プロパティ名 | 型 | 説明 |
| --- | --- | --- |
| `id` | string | `[Unix timestamp in ms]-[5-digit random uppercase alphanumeric]`のフォーマットでCellを一意に識別します。ID前半はUNIXミリ秒の現在時刻、後半は5桁のランダムな大文字英数字。 |
| `attribute` | string | Cellの属性 (`Card`, `Time`, `Text`, `Task`) を特定するメンバ。Cellに記録する値や使用するUIが属性によって変化する。|
| `name` | string | Cellの名前(Cellタイトル) 。属性によって制限がある。空文字列で初期化し生成呼び出し側で値を決定する。|
| `value` | string | Cellの記録する値。属性によって制限がある。空文字列で初期化し生成呼び出し側で値を決定する。|
| `geo` | string \| null | Cell作成時の位置情報（緯度 経度 高度 の順で値スペース区切るだけのシンプルな記録法）。取得不可時は `null` を入れる。 位置情報（`geo`）はインスタンスの生成（コンストラクタ実行）時に自動的に記録され、これが唯一の記録タイミングとなります。
|
| `remove` | string \| null | Cellの除外判定。除外されている場合はUNIXミリ秒のタイムスタンプを記録、そうでない場合は `null` を入れる。 |

### 2.3.1 Cellの生成時間
Cellは生成時間を直接にメンバには持たないが、IDに生成時のタイムスタンプを使用するため、IDの前半の数値をUNIXミリ秒と解釈する事で生成時間を取り出す事ができる。

## 2.4 属性ごとの定義と挙動

### 2.4.4 Cardセル
- **定義**: 他のCellをグループ化（パッケージ化）するための特殊なCell。
- **attribute**: `Card`
- **name**: "Card"で固定。※将来的に変更する可能性もある
- **value**: カードに含まれる子Cellの `id` をスペース区切りで記録する。idの並びはUI上で利用するので重要。
- **挙動**: 
    -`Cell.addCellId()` や `Cell.removeCellId()` メソッドを通じて、所属するCellのリストを管理する。
    - Cardに新しい子セルを追加追加した場合は既に記録されている子セルのIDの末尾に追加する

### 2.4.1 Timeセル
- **定義**: 時刻情報を保持するためのセル。
- **attribute**: `Time`
- **name**: デフォルトでは "Time"を入力する。
- **value**: UNIXミリ秒を文字列で保持。生成時に指定がない場合は現在のタイムスタンプが設定される。UIを通してユーザーが変更することができる。
- **挙動**: UIに記録されている時間を表示する。

### 2.4.2 Textセル
- **定義**: 任意のテキスト情報を保持するためのセル。
- **attribute**: `Text`
- **name**: 任意（空文字可）。
- **value**: 任意の文字列(空文字列可)。
- **挙動**: 最も汎用的なセルでテキストデータの記録と操作を行う。

### 2.4.3 Taskセル
- **定義**: タスク情報とその完了状態を管理するためのセル。
- **attribute**: `Task`
- **name**: タスク内容を表す任意の文字列(空文字可)。
- **value**: 完了時には現在時刻のUNIXミリ秒を記録し完了状態を表現し、未完了状態は空文字列で表現する。ユーザーはUIを通して完了と未完了を切り替える。
- **挙動**: 値があるかどうかでタスクの「未完了/完了」を判定しUIの挙動を変える。
