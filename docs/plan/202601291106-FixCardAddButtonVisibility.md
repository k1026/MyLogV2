# カード展開時にカード追加ボタンが非表示にならないバグの修正計画

## 1. 要件定義

### 概要
カードリスト UI でリスト内のカードを直接クリックして展開した際、画面右下の「カード追加ボタン (FAB)」が表示されたままになるバグを修正します。

### 期待される挙動
*   リスト上のカードをタップして展開したとき、カード追加ボタンが非表示になる。
*   展開されたカードを閉じたとき、カード追加ボタンが再表示される。

### 原因
`CardList` コンポーネント内でカードが展開された際（`handleExpand`）、その情報が親コンポーネント（`app/page.tsx`）に通知されていないため、親の状態 `focusedCardId` が更新されず、ボタンの `visible` プロパティが `true` のままになっている。

## 2. 実装計画

### Step 1: `CardList` のテストコード更新
カードを展開した際にコールバックが呼ばれることを確認するテストを追加します。
*   **ファイル**: `app/components/CardList/CardList.test.tsx`
*   **内容**: 
    *   `onFocus` プロパティが正しい ID で呼び出されることを確認するテストケースを追加。

### Step 2: `CardList` コンポーネントの修正
親コンポーネントへ通知するためのプロパティを追加し、展開時に実行します。
*   **ファイル**: `app/components/CardList/CardList.tsx`
*   **変更点**:
    *   `CardListProps` に `onFocus?: (id: string) => void` を追加。
    *   `handleExpand` 関数内で `onFocus(id)` を呼び出すように修正。

### Step 3: `Home` コンポーネントの修正
`CardList` からの通知を受け取り、ページの状態を更新するように紐付けます。
*   **ファイル**: `app/page.tsx`
*   **変更点**:
    *   `CardList` コンポーネントの呼び出し箇所に `onFocus={setFocusedCardId}` を追加。

## 3. 検証計画

### 自動テスト
*   `npm test app/components/CardList/CardList.test.tsx` を実行し、追加したテストがパスすることを確認。

### 手動確認
1.  開発サーバーを起動 (`npm run dev`)。
2.  ブラウザでカードリストを表示。
3.  カードのいずれかをクリックして展開する。
4.  右下の紫色の十字ボタン（カード追加ボタン）が消えることを確認。
5.  カードの「×」ボタンを押して閉じる。
6.  カード追加ボタンが再表示されることを確認。
