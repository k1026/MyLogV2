
 RUN  v4.0.18 C:/tojiro/programming/AG/MyLogV2

 ✓ app/lib/db/operations.test.ts (13 tests) 155ms
 ✓ app/components/card/cardUtils.test.ts (6 tests) 190ms
 ✓ app/contexts/LocationContext.test.tsx (4 tests) 112ms
 ✓ app/components/cell/TitleCandidates.test.tsx (3 tests) 143ms
 ✓ app/components/CardList/CardAddButton.test.tsx (4 tests) 190ms
 ✓ app/contexts/UIStateContext.test.tsx (5 tests) 281ms
 ✓ app/components/card/CardToolbar.test.tsx (4 tests) 208ms
 ✓ app/contexts/RarityContext.test.tsx (3 tests) 199ms
stderr | app/components/Header/Header.test.tsx > Header Component > renders card counts correctly
Received `true` for a non-boolean attribute `jsx`.

If you want to write it to the DOM, pass a string instead: jsx="true" or jsx={value.toString()}.
Received `true` for a non-boolean attribute `global`.

If you want to write it to the DOM, pass a string instead: global="true" or global={value.toString()}.

 ✓ app/hooks/useCardList.test.ts (2 tests) 383ms
 ✓ app/components/cell/TimeCell.test.tsx (7 tests) 377ms
stderr | app/components/cell/TextCell.test.tsx > TextCell > Enterキー操作: name フィールドで Enter を押すと value フィールドへ移動すること
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 ✓ app/components/cell/CellContainer.test.tsx (2 tests) 282ms
stderr | app/components/cell/TextCell.test.tsx > TextCell > フォーカス制御 (仕様 4.2.2) > 初期フォーカス: 両方空の場合は name にフォーカス
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 ✓ app/components/Header/Header.test.tsx (5 tests) 410ms
stderr | app/components/cell/TextCell.test.tsx > TextCell > フォーカス制御 (仕様 4.2.2) > 初期フォーカス: valueのみある場合は name にフォーカス
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

stderr | app/components/cell/TextCell.test.tsx > TextCell > フォーカス制御 (仕様 4.2.2) > 過剰なフォーカス奪取の防止: isNew=trueでも、一度フォーカスが外れたら再取得しないこと
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TextCell inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 ✓ app/components/cell/TextCell.test.tsx (14 tests) 826ms
 ✓ app/components/card/CardFAB.test.tsx (6 tests) 1056ms
     ✓ renders the FAB button  654ms
 ✓ app/components/CardList/CardList.test.tsx (4 tests) 1077ms
     ✓ should render only a subset of cards (90 limit)  756ms
 ✓ app/components/card/Card.test.tsx (9 tests) 1004ms
     ✓ renders the card container  339ms
 ✓ app/components/card/CardDisplay.test.tsx (2 tests) 1107ms
     ✓ renders Time and Text cells for a newly created card  1047ms
Not implemented: Window's alert() method
Not implemented: navigation to another Document
stderr | app/components/db-viewer/DbViewer.test.tsx > DbViewer > 閉じるボタンをクリックすると onClose が呼ばれること
An update to DbViewer inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

stderr | app/components/db-viewer/DbViewer.test.tsx > DbViewer > 閉じるボタンをクリックすると onClose が呼ばれること
An update to DbViewer inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to DbViewer inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 ✓ app/components/db-viewer/DbViewer.test.tsx (6 tests) 1819ms
     ✓ isOpen=true の時に表示され、ロゴ、操作ボタン、リスト情報、リストヘッダーが存在すること  1132ms
 ✓ app/lib/db/fileIO.test.ts (7 tests) 76ms
 ✓ app/lib/services/estimation/CellTitleEstimationService.test.ts (4 tests) 45ms
 ✓ app/lib/services/LocationService.test.ts (4 tests) 8ms
 ✓ app/lib/models/cell.test.ts (8 tests) 14ms
 ✓ app/lib/filter/cardFilter.test.ts (7 tests) 19ms
 ✓ app/hooks/useAutoVisibility.test.ts (4 tests) 67ms
 ✓ app/lib/rarity/RarityCalculator.test.ts (5 tests) 8ms
 ✓ app/components/card/useCardSort.test.ts (5 tests) 56ms
 ❯ app/components/cell/TaskCell.test.tsx (10 tests | 6 failed) 26025ms
     ✓ 初期表示: name と value (チェック状態) が正しく表示されること  743ms
     ✓ チェックボックスをクリックすると onSave が即座に呼ばれること 131ms
     ✓ nameを編集してblurするとonSaveが呼ばれること 28ms
     ✓ コンテナをクリックするとタイトルのテキストフィールドにフォーカスが当たり、テキストが全選択されること 20ms
     × 過剰なフォーカス奪取の防止: isNew=trueでも、一度フォーカスが外れたら再取得しないこと 50ms
       × 新規セル追加時に自動で推定結果の1位がセットされること 5009ms
       × 新規セル追加時に候補チップが表示されること 5005ms
       × 候補チップをクリックするとタイトルが更新され、チップが消えること 5004ms
       × 手動で入力すると候補チップが消えること 5019ms
     × 競合状態の防止: 推定処理中にユーザーが入力を開始した場合、推定結果で上書きされないこと 5011ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 6 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  app/components/cell/TaskCell.test.tsx > TaskCell > 過剰なフォーカス奪取の防止: isNew=trueでも、一度フォーカスが外れたら再取得しないこと
Error: expect(element).not.toHaveFocus()

Received element is focused:
  <input
  class="bg-transparent border-b-2 border-transparent outline-none transition-all duration-300 text-left font-bold text-[20px] p-3 rounded-none placeholder:text-slate-400 flex-1 w-full focus:border-purple-500 text-transparent"
  placeholder="To-do Task"
  type="text"
  value="New Task"
/>
 ❯ app/components/cell/TaskCell.test.tsx:104:31
    102|         // ユーザーが脱出
    103|         fireEvent.blur(nameInput);
    104|         expect(nameInput).not.toHaveFocus();
       |                               ^
    105| 
    106|         // 再レンダリング (isNew=true のまま)

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/6]⎯

 FAIL  app/components/cell/TaskCell.test.tsx > TaskCell > 推定機能 (Estimation) > 新規セル追加時に自動で推定結果の1位がセットされること
Error: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
 ❯ app/components/cell/TaskCell.test.tsx:119:9
    117| 
    118|     describe('推定機能 (Estimation)', () => {
    119|         it('新規セル追加時に自動で推定結果の1位がセットされること', async () => {
       |         ^
    120|             const cell = new Cell({ ...baseCell, name: '', value: 'fal…
    121|             render(<TaskCell cell={cell} onSave={mockSave} isNew={true…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/6]⎯

 FAIL  app/components/cell/TaskCell.test.tsx > TaskCell > 推定機能 (Estimation) > 新規セル追加時に候補チップが表示されること
Error: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
 ❯ app/components/cell/TaskCell.test.tsx:128:9
    126|         });
    127| 
    128|         it('新規セル追加時に候補チップが表示されること', async () => {
       |         ^
    129|             const cell = new Cell({ ...baseCell, name: '', value: 'fal…
    130|             render(<TaskCell cell={cell} onSave={mockSave} isNew={true…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/6]⎯

 FAIL  app/components/cell/TaskCell.test.tsx > TaskCell > 推定機能 (Estimation) > 候補チップをクリックするとタイトルが更新され、チップが消えること
Error: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
 ❯ app/components/cell/TaskCell.test.tsx:137:9
    135|         });
    136| 
    137|         it('候補チップをクリックするとタイトルが更新され、チップが消えること', async () => {
       |         ^
    138|             const cell = new Cell({ ...baseCell, name: '', value: 'fal…
    139|             render(<TaskCell cell={cell} onSave={mockSave} isNew={true…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/6]⎯

 FAIL  app/components/cell/TaskCell.test.tsx > TaskCell > 推定機能 (Estimation) > 手動で入力すると候補チップが消えること
Error: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
 ❯ app/components/cell/TaskCell.test.tsx:149:9
    147|         });
    148| 
    149|         it('手動で入力すると候補チップが消えること', async () => {
       |         ^
    150|             const cell = new Cell({ ...baseCell, name: '', value: 'fal…
    151|             render(<TaskCell cell={cell} onSave={mockSave} isNew={true…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/6]⎯

 FAIL  app/components/cell/TaskCell.test.tsx > TaskCell > 競合状態の防止: 推定処理中にユーザーが入力を開始した場合、推定結果で上書きされないこと
Error: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
 ❯ app/components/cell/TaskCell.test.tsx:162:5
    160|     });
    161| 
    162|     it('競合状態の防止: 推定処理中にユーザーが入力を開始した場合、推定結果で上書きされないこと', async () => {
       |     ^
    163|         // estimateが少し遅れるように遅延させる
    164|         mockEstimate.mockImplementation(async () => {

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/6]⎯


 Test Files  1 failed | 26 passed (27)
      Tests  6 failed | 147 passed (153)
   Start at  17:15:50
   Duration  35.40s (transform 7.79s, setup 20.16s, import 36.79s, tests 36.14s, environment 125.51s)

