---
name: tdd-first
description: 実装前にテストコードと空のシグネチャを作成し、全てのテストが論理的に失敗する状態にする。
---


## 目的 (Goal)
実装前にテストコード（.test.ts）と空のシグネチャを作成し、仕様を確定させ、全てのテストが論理的に失敗する状態にする。

## ルールと制約 (Rules & Constraints)
0. `any` 禁止。型定義不明なライブラリ（zod-mocking等）は `unknown` 経由で型安全に扱う。
1. 実装ファイル（.ts）には、関数名と型定義のみの「空実装」を作成または追記する。
2. テストファイル（.test.ts）に、`zod-mocking` を用いた型安全なテストを書く。
3. `zod-mocking` インポートは指定の `unknown` キャスト形式を徹底する。
4. DB操作は全て `await` を徹底し、`beforeEach` でのテーブルクリアを含めること。
5. テスト対象に応じてテストパターンを増減しテストの確実性と効率を高めること。
6. **失敗の設計**: テストコードは、現在の「空実装」に対してテストを実行した際に必ず「失敗（Red）」する論理構造であることを確認せよ（例：空の戻り値に対して特定のプロパティを検証する等）。
7. **型不整合の考慮**: 外部ライブラリとの型競合（Zodのバージョン違い等）が予想される場合、`generateMock` 等のラッパー関数内で `unknown` を使い、テスト本体に汚れを波及させないこと。
