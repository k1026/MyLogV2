# MyLog Project Rules (Next.js 16)

You are an expert full-stack developer specializing in Next.js 16, TypeScript, and AI-driven development. Always act as a high-performance engineer.

## 1. Core Technology Stack
- **Framework:** Next.js 16 (App Router)
- **Language:** TypeScript (Strict Mode)
- **Styling:** Tailwind CSS 4
- **Database:** Dexie.js (IndexedDB / Local-First)
- **Data Fetching:** TanStack Query (React Query)
- **Form/Validation:** React Hook Form + Zod
- **Infrastructure:** PWA (Progressive Web App)
- **Linter:** ESLint (Next Core Web Vitals)

## 2. Specification Policy
- **Source of Truth:** All app specifications are located in `docs/specs/*.md`.
- **Requirement:** Strictly adhere to these specifications.
- **Conflict Resolution:** If there is a conflict between existing code and the specifications, the specifications in `docs/specs` always take precedence.

## 3. Development Rules

### Specification-Driven Development
1. **Source of Truth:** Always refer to the `.md` files in `docs/specs` for application requirements.
2. **Prioritization:** The specifications in `docs/specs` take precedence over any existing code or patterns.
3. **Requirement Analysis:** If you find any flaws, ambiguities, or logical contradictions in the specifications, you must report them to the user immediately for clarification instead of proceeding with the implementation.

### Code Quality
- Follow the project's ESLint and formatting rules as defined in the configuration files.

| Step / Pattern | Skill Path (RAG) | Goal |
| :--- | :--- | :--- |
| **@cording** | `.agent/skills/cording/SKILL.md` | プロジェクト標準規約とディレクトリ設計の遵守。 |
| **@compact** | `.agent/skills/compact/SKILL.md` | 挨拶・解説を排除し、差分コードのみを高速出力。 |
| **@focus** | `.agent/skills/focus/SKILL.md` | 最小限の読み込みによるピンポイントな外科的修正。 |
| **@strict** | `.agent/skills/strict/SKILL.md` | `any` 禁止、型安全性とLintの徹底チェック。 |
| **@tdd-first** | `.agent/skills/tdd-first/SKILL.md` | Step 1: Test-First. 生成後は人間が `npm run test:ai` を実行。 |
| **@tdd-fix** | `.agent/skills/tdd-fix/SKILL.md` | Step 2: `test-results.log` を読み取り、実装を修正。 |
| **@tdd-strict** | `.agent/skills/tdd-strict/SKILL.md` | Step 3: 修正箇所の型安全確認とリファクタリング。 |

## 4. Global Constraints
1. **Strict Linting:** Always follow the project s `eslint.config.mjs`.
2. **No SED:** Never use `sed` for code editing; it risks breaking JSX/TSX structures.
3. **Path First:** Always identify and state the target file path before proposing changes (Always follow `@compact` rules).
4. **Type Safety:** No `any` or `@ts-ignore`. Use Zod for data validation (SSOT).
5. **TDD Workflow:** Follow the 3-step physical separation. AI never runs tests; humans do.
6. **Zod Mocking:** Use the `unknown` cast pattern for `zod-mocking` to ensure Strict Mode compliance.

## 5. Versioning Rule
- **App Version Format:** `yy.mm.dd` (e.g., 26.01.25)

---
Current Status: Ready for implementation. Mention a skill (e.g., `@test`, `@compact`) to activate specific rule sets.